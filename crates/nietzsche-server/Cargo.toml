[package]
name = "nietzsche-server"
version = "0.1.0"
edition = "2021"
description = "NietzscheDB production gRPC server binary"

[[bin]]
name = "nietzsche-server"
path = "src/main.rs"

# ── Features ──────────────────────────────────────────────────────────────────
[features]
default = []
# GPU-accelerated vector search via NVIDIA cuVS CAGRA.
# Requires CUDA 12.x + cuVS 24.6 + libclang on the build host.
# Build: cargo build --release --features gpu
# Run:   NIETZSCHE_VECTOR_BACKEND=gpu ./nietzsche-server
gpu = ["dep:nietzsche-hnsw-gpu", "nietzsche-lsystem/cuda"]
# Google TPU-accelerated vector search via PJRT C API + MHLO MLIR.
# Requires: Cloud TPU VM (v5e / v6e Trillium / v7 Ironwood) OR local libtpu.so.
# Build: cargo build --release --features tpu
# Run:   PJRT_PLUGIN_PATH=/lib/libtpu.so NIETZSCHE_VECTOR_BACKEND=tpu ./nietzsche-server
tpu = ["dep:nietzsche-tpu", "nietzsche-tpu/tpu"]

[dependencies]
nietzsche-api         = { workspace = true }
nietzsche-graph       = { workspace = true }
nietzsche-hnsw-gpu    = { workspace = true, optional = true }
nietzsche-tpu         = { workspace = true, optional = true }
nietzsche-sleep       = { workspace = true }
nietzsche-query       = { workspace = true }
nietzsche-zaratustra  = { workspace = true }
nietzsche-algo        = { workspace = true }
nietzsche-cluster     = { workspace = true }
nietzsche-wiederkehr  = { workspace = true }
nietzsche-agency      = { workspace = true }
nietzsche-hyp-ops     = { workspace = true }
nietzsche-lsystem     = { workspace = true }
nietzsche-dream       = { workspace = true }
nietzsche-narrative   = { workspace = true }
nietzsche-neural      = { workspace = true }
nietzsche-dsi         = { workspace = true }
nietzsche-vqvae       = { workspace = true }
tokio           = { workspace = true }
tonic           = { workspace = true }
tracing         = { workspace = true }
rand            = { workspace = true }
serde           = { workspace = true }
uuid            = { workspace = true }
tracing-subscriber = { version = "0.3", features = ["env-filter", "fmt"] }
anyhow = "1.0"
tonic-reflection = "0.10"
axum = "0.7"
tower-http = { version = "0.5", features = ["cors"] }
serde_json = "1.0"
ordered-float = { workspace = true }
sha2 = "0.10"
hex = "0.4"
